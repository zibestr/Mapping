# Описание алгоритмов работы
## Уточняющая информация
```
У филиалов вузов одинаковый ИНН, но разный КПП (код причины постановки).
```
## Parsing нового списка вузов
1. Сбор организацией имеющих лицензию от Федеральной службы надзора в сфере образования и науки на осуществление высшего образования в РФ с [реестра Рособрнадзора](https://obrnadzor.gov.ru/gosudarstvennye-uslugi-i-funkczii/gosudarstvennye-uslugi/liczenzirovanie-obrazovatelnoj-deyatelnosti/svodnyj-reestr-liczenzij/)
2. Удаление научных институтов, школ, и тд из списка: 
 - основным критерием было наличие слово сочетания **"высшего образования"** в полном наименование учреждения.
3. Сбор юридических данных об организациях с помощью [API Dadata](https://dadata.ru/api/):
- Проверить организацию на существование;
- Собрать ИНН, ОГРН, КПП, юр. адрес, регион, федеральный округ организации;
- Сформировать 2 списка для ручной проверки:
    - список ликвидированных организаций (цель - найти новую или подтвердить ее ликвидацию)
    - список с неверными указанными ИНН или КПП (цель - отредактировать ИНН и КПП, чтобы организация пробивалась через API Dadata)
4. Проставить флаг "Филиал" - если в полном название есть слово филиал, то 1, иначе 0.
## Mapping вузов
1. Из старого списка выбрать названия только вузов с помощью регулярных выражений.
2. Дополнить названия вузов в новом списке:
- скопировать названия, которые содержат министерство и удалить его из этих названий;
- скопировать названия, которые содержат "российская федерация" и заменить на РФ;
- скопировать краткие названия, которые содержать "ФГБОУ ВО" и удалить это значения из выбранных названий;
- скопировать названия, которые содержат юридические наименования (федеральное, государственное и тд), и удалить их из них;
3. Нормализовать все названия вузов:
- Привести к нижнему регистру;
- Удалить из строки все символы, кроме букв и пробелов;
- Заменить 2 и более пробелов идущих подряд на 1 пробел.
4. Векторизовать названия вузов с помощью алгоритма [Bag of Words (BoW)](https://en.wikipedia.org/wiki/Bag-of-words_model).
5. Вычислить cosine similarity для каждой пары векторов из нового и старого списка по формуле:

    $cosine similarity(v_1, v_2) = \frac{v_1 v_2}{\lVert v_1 \rVert \lVert v_2 \rVert}$

6. Отобрать пары векторов, у которых cosine similarity >= 0.97.
7. Отобранные пары векторов добавить в таблицу для mapping'а, с указанием старого id вуза и id в новой базе.